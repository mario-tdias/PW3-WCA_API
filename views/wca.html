{% extends 'base.html' %}
{% block content %}
<div class="container container-narrow">
    <h2 class="text-center mb-4">WCA - Competidores</h2>
    <form method="get" action="{{ url_for('wcaCompetitors') }}" class="row g-3 mb-4 justify-content-center">
        <div class="col-auto">
            <input type="text" name="q" value="{{ query }}" class="form-control" placeholder="Buscar por nome (ex: Feliks)" />
        </div>
        <div class="col-auto">
            <button type="submit" class="btn btn-primary">Buscar</button>
        </div>
    </form>
    <div class="text-center text-muted mb-4">
        <small>Exemplos de busca:
            <a href="{{ url_for('wcaCompetitors') }}?q=Yiheng%20Wang" class="link-secondary">Yiheng Wang</a>,
            <a href="{{ url_for('wcaCompetitors') }}?q=Max%20Park" class="link-secondary">Max Park</a>,
            <a href="{{ url_for('wcaCompetitors') }}?q=Tymon%20Kolasinski" class="link-secondary">Tymon Kolasinski</a>,
            <a href="{{ url_for('wcaCompetitors') }}?q=Sebastian%20Weyer" class="link-secondary">Sebastian Weyer</a>,
            <a href="{{ url_for('wcaCompetitors') }}?q=Mats%20Valk" class="link-secondary">Mats Valk</a>
        </small>
    </div>

    {% if error %}
    <div class="alert alert-danger">{{ error }}</div>
    {% endif %}

    {% if query and competitors|length == 0 and not error %}
    <div class="centered-empty">Nenhum competidor encontrado para "{{ query }}".</div>
    {% endif %}

    <div class="row g-4 justify-content-center">
        {% for c in competitors %}
        <div class="col-sm-6 col-md-4 col-lg-3">
            <div class="card p-2 h-100">
                <div class="card-body">
                    <div class="d-flex align-items-center mb-3">
                        <img src="{{ c.avatar_thumb_url or c.avatar_url or 'data:image/svg+xml;utf8,<svg xmlns=\'http://www.w3.org/2000/svg\' width=\'56\' height=\'56\'><rect width=\'100%\' height=\'100%\' fill=\'%23eeeeee\'/><text x=\'50%\' y=\'55%\' dominant-baseline=\'middle\' text-anchor=\'middle\' font-size=\'18\' fill=\'#bbb\'>?</text></svg>' }}" alt="avatar" class="me-3" style="width:56px; height:56px; object-fit:cover; border-radius:50%; border:1px solid #ddd;"/>
                        <div>
                            <h5 class="card-title mb-0">{{ c.name }}</h5>
                            <small class="text-muted">{{ c.wca_id or 'â€”' }}</small>
                        </div>
                    </div>
                    <ul class="list-unstyled small mb-3">
                        <li class="mb-1"><span class="text-muted">PaÃ­s:</span> <strong>{{ c.country_iso2 or 'â€”' }}</strong></li>
                        <li class="mb-1"><span class="text-muted">CompetiÃ§Ãµes:</span> <strong>{{ c.competition_count if c.competition_count is not none else 'â€”' }}</strong></li>
                    </ul>
                    <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                        <span class="badge text-bg-warning">ðŸ¥‡ {{ c.medals_gold if c.medals_gold is not none else 'â€”' }}</span>
                        <span class="badge text-bg-secondary">ðŸ¥ˆ {{ c.medals_silver if c.medals_silver is not none else 'â€”' }}</span>
                        <span class="badge text-bg-bronze">ðŸ¥‰ {{ c.medals_bronze if c.medals_bronze is not none else 'â€”' }}</span>
                        <span class="badge text-bg-light border">Total: {{ c.medals_total if c.medals_total is not none else 'â€”' }}</span>
                    </div>
                    <div class="d-flex flex-wrap align-items-center gap-2 mb-2">
                        <span class="badge text-bg-dark">WR: {{ c.records_wr if c.records_wr is not none else 'â€”' }}</span>
                        <span class="badge text-bg-info text-dark">CR: {{ c.records_cr if c.records_cr is not none else 'â€”' }}</span>
                        <span class="badge text-bg-success">NR: {{ c.records_nr if c.records_nr is not none else 'â€”' }}</span>
                        <span class="badge text-bg-light border">Rec.: {{ c.records_total if c.records_total is not none else 'â€”' }}</span>
                    </div>
                    {% if c.profile_url %}
                    <a href="{{ c.profile_url }}" target="_blank" class="btn btn-sm btn-outline-secondary">Ver perfil</a>
                    {% endif %}
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock content %}


